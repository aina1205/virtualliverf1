<script type="text/javascript">
  var loaded_scales = new Array();
  //loaded_scales['organism'] = false;
  loaded_scales['all'] = true;
</script>
<%= render :partial => 'scales/scale_slider', :locals => {:current_scale => 'all',:scale_slider_function => (remote_function(
        :url=>{:action=>'scale_search', :controller=>'scales'},
        :with=>"'scale_type='+this.id",
        :before=>"show_ajax_loader(this.id+'_results')",
        :condition=>'!loaded_scales[this.id]') +
        "; loaded_scales[this.id] = true;
        $$('#scaled_items > div').invoke('hide');
        $(this.id+'_results').show();")} %>

<!--Inserting the javascripts for loading tabber dynamically-->
<div id="js_for_tabber"></div>

<%= javascript_include_tag "tabber-minimized.js" %>
<script type="text/javascript">
    function load_tabs() {
        var tabberOptions = {'onLoad':function() {
            displayTabs();
        }};
        tabberAutomatic(tabberOptions);
    }

    function tabs_on_click(resource_type, resource_ids, scale){
        document.getElementsByClassName(scale + '_' + resource_type)[0].onclick = function(){
                request = new Ajax.Request('<%= url_for(:controller => 'application', :action => 'view_items_in_tab1') %>',
                        {
                            method: 'get',
                            parameters: {
                                resource_type: resource_type,
                                resource_ids: resource_ids,
                                scale: scale
                            },
                            onLoading: show_large_ajax_loader(scale + '_list_items_container'),
                            onFailure: function(transport){
                                alert('Something went wrong, please try again...');
                            }
                        });
            }

    }
</script>

<div id="scaled_items">
    <div id="all_results" class="scaled_items">
      <% resource_hash = classify_for_tabs_light_weight @scaled_objects -%>
      <%= render :partial => "assets/resource_listing_tabbed_by_class_lightweight",
                   :locals => {:resource_hash => resource_hash,
                               :narrow_view => true,
                               :authorization_already_done => true,
			                   :limit => 5,
			                   :actions_partial_disable => true} -%>
    </div>
    <% scale_titles = Scale.all.map(&:title)
       scale_titles = ['all'] + scale_titles
       scale_titles.reject{|s| s == 'all'}.each do |s|%>
    <div id="<%= s %>_results" class="scaled_items" style="display: none;"></div>
    <% end %>
</div>





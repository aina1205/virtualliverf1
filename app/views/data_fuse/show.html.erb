<% select_truncate_length = 25 -%>
<div class="show_basic">
  <% form_tag({:action=>:assets_selected},:method=>:post) do -%>
  <%= @data_files.count -%> Data Files found
  <br/>
  <%= @models.count -%> Models found

  <%= select_tag :model_id,
      options_for_select([["Select Model file ...",0]]|@models.collect{|s| [truncate(h(s.title),:length=>select_truncate_length),s.id]}),
          {:style=>"width:90%",:onchange=>remote_function(
            :url=>{:action=>"preview",:controller=>"models",:element=>"model_preview"},
            :with=>"'id='+this.value",
            :before=>"show_ajax_loader('model_preview')"
          )+";"+remote_function(
            :url=>{:action=>"parameter_keys",:controller=>"data_fuse",:element=>"parameter_keys"},
            :with=>"'id='+this.value",
            :before=>"show_ajax_loader('parameter_keys')"
          )
   }

  -%>

  <div id="parameter_keys" style="overflow-y:scroll;max-height:25em;width: 20em;padding-bottom:1em;float:right;">
    df
  </div>

  <div id="model_preview" class="preview_box">

  </div>

  <%= select_tag :data_file_id,
          options_for_select([["Select Data file ...",0]]|@data_files.collect{|s| [truncate(h(s.title),:length=>select_truncate_length),s.id]}),
          {:style=>"width:90%",:onchange=>remote_function(
            :url=>{:action=>"preview",:controller=>"data_files",:element=>"data_file_preview"},
            :with=>"'id='+this.value",
            :before=>"show_ajax_loader('data_file_preview')"
          )+";"+remote_function(
            :url=>{:action=>"data_file_csv",:controller=>"data_fuse",:element=>"csv_view"},
            :with=>"'id='+this.value",
            :before=>"show_ajax_loader('csv_view')"
          )
   } -%>

  <div id="data_file_preview" class="preview_box">
    
  </div>
  <div id="csv_view">

  </div>
  <%= submit_tag "Send",:disable_with=>"Sending..." -%>
  <% end -%>
</div>
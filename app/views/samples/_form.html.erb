<%= javascript_include_tag 'calendar_date_select/calendar_date_select' %>
<%= stylesheet_link_tag 'calendar_date_select/default' %>
<%= javascript_include_tag "sharing.js" -%>

<%= f.error_messages %>


<h2>Sample Details</h2>

<div style="width: 95%;">

  <p>
    <%= f.label "Sample name:" -%><span class="required">*</span><br/>
    <%= f.text_field :title, :style => "width: 350px;" -%>
  </p>
  <p>
    <%= f.label :description -%><br/>
    <%= f.text_area :comments, :style => "width: 85%;", :rows => 5 -%>
  </p>
  <p>
    <%= f.label "Choose a specimen" %> <span class="required">*</span><br/>
    <%= collection_select(:sample, :specimen_id, Specimen.all.select{|s|s.can_view?} , :id, :title,{:include_blank =>"Please Select..."},{:style=>"width:90%"}) %>
  </p>

  <p>
    <%= f.label "Explantation time" -%><br/>
    <%= f.text_field :explantation, :style => "width: 350px;" -%>
  </p>

  <p>
    <%= f.label :lab_internal_number -%><span class="required">*</span><br/>
    <%= f.text_field :lab_internal_number, :style => "width: 350px;" -%>
  </p>
  <p>
    <%= f.label :donation_date -%><span class="required">*</span><br/>
    <%= f.calendar_date_select :donation_date, :time => "mixed" -%>
  </p>



  <%= render :partial => 'projects/project_selector', :locals => {:resource => @sample,:allow_nil=>true}%>

  <br style="clear:both"/>
  <p>
      <%= render :partial => "assets/sharing_form" -%>
  </p>

  <%= render :partial => 'assets/special_auth_code_form', :locals => {:f => f}%>

  <%= fancy_multiselect @sample, :data_files, :name => 'sample_data_file_ids', :association_class => DataFile,:selected => (params[:sample_data_file_ids] || []).map(&:to_i) | @sample.data_file_masters.map(&:id) %>
  <%= fancy_multiselect @sample, :models, :name => 'sample_model_ids', :association_class => Model,:selected => (params[:sample_model_ids] || []).map(&:to_i) | @sample.model_masters.map(&:id) %>
  <%= fancy_multiselect @sample, :sops, :name => 'sample_sop_ids', :association_class => Sop,:selected => (params[:sample_sop_ids] || []).map(&:to_i) | @sample.sop_masters.map(&:id) %>
</div>

<%= f.hidden_field :from_new_link %>

<p style="margin-top: 2em; text-align: center;">
  <%= f.submit(action==:edit ? "Update" : "Create", :disable_with=>(action==:edit ? "Updating..." : "Creating...")) -%>
  or <%= link_to 'Cancel', (@sample.id ? sample_path(@sample.id) : samples_path) -%>
</p>
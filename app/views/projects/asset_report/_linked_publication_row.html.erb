<% pub = linked_publication_row
   models = pub.all_related_models
   data = pub.all_related_data_files
-%>
<tr>
  <td>
    <%= pub.title -%>
  </td>
  <td><%= link_to polymorphic_url(pub), polymorphic_url(pub) -%></td>
  <td>
    <%= !pub.pubmed_id.nil? ? pub.pubmed_id : pub.doi %>
  </td>
  <td>
    <% organisms=pub.related_organisms -%>
    <% if organisms.empty? -%>
        <span class='none_text'>Unknown</span>
    <% else %>
        <table class="inner_linked_assets">
          <% organisms.each do |organism| -%>
              <tr>
                <td><%= organism.title -%></td>
              </tr>
          <% end -%>
        </table>
    <% end -%>
  </td>
  <td>
    <% if organisms.empty? -%>
        <span class='none_text'>Unknown</span>
    <% else %>
        <table class="inner_linked_assets">
          <% organisms.each do |organism| -%>
              <tr>
                <td><%= organism.ncbi_id.nil? ? "<span class='none_text'>Unknown</span>" : organism.ncbi_id -%></td>
              </tr>
          <% end -%>
        </table>
    <% end -%>
  </td>
  <td>
    <table class='inner_linked_assets'>
      <% data.each do |df| -%>
          <% cls = df.can_download?(nil) ? '' : 'notpublic' -%>
          <tr class='<%= cls -%>'>
            <td><%= df.can_view? ? df.title : "<span class='none_text'>Hidden</span>" -%></td>
          </tr>
      <% end -%>
    </table>
  </td>
  <td>
    <table class='inner_linked_assets'>
      <% data.each do |df| -%>
          <% cls = df.can_download?(nil) ? '' : 'notpublic' -%>
          <tr class='<%= cls -%>'>
            <td><%= link_to polymorphic_url(df), polymorphic_url(df) -%></td>
          </tr>
      <% end -%>
    </table>
  </td>
  <td>
    <table class='inner_linked_assets'>
      <% models.each do |model| -%>
          <% cls = model.can_download?(nil) ? '' : 'notpublic' -%>
          <tr class='<%= cls -%>'>
            <td><%= model.can_view? ? model.title : "<span class='none_text'>Hidden</span>" -%></td>
          </tr>
      <% end -%>
    </table>
  </td>
  <td>
    <table class='inner_linked_assets'>
      <% models.each do |model| -%>
          <% cls = model.can_download?(nil) ? '' : 'notpublic' -%>
          <tr class='<%= cls -%>'>
            <td><%= link_to polymorphic_url(model), polymorphic_url(model) -%></td>
          </tr>
      <% end -%>
    </table>
  </td>
</tr>

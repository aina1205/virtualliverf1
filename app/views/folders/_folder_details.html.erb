<%
   @folder = folder_details
-%>

<ul id="folder_details">
  <li class="title_and_description">
    <% if @folder.editable? -%>

        <div>
          <span id="title_label"><b>Title: </b></span>
          <%= in_place_editor_field :folder, 'title', {}, {
                  :external_control=>:title_label,
                  :url=>url_for(:project_id=>@project.id, :action=>:set_project_folder_title, :id=>@folder.id)
          } %>
        </div>

        <div>
          <span id="description_label"><b>Description: </b></span>
          <%= in_place_editor_field :folder, 'description', {}, {
                  :rows=>1,
                  :cols=>50,
                  :external_control=>"description_label",
                  :url=>url_for(:project_id=>@project.id, :action=>:set_project_folder_description, :id=>@folder.id)} -%>
        </div>
    <% else -%>
        <div>
            <b>Title: </b><%= @folder.is_a?(Seek::AssayFolder) ? link_to(h(@folder.title),@folder.assay) : h(@folder.title) -%>
        </div>
        <div>
            <b>Description: </b><%= h(@folder.description) -%>
        </div>
    <% end -%>
  </li>

  <li class="actions">
    <% if @folder.deletable? -%>
        <% unsorted_folder = ProjectFolder.new_items_folder(@project).try(:title) -%>
        <div>
        <%= image_tag_for_key "destroy", project_folder_path(@project, @folder),
                              "Delete this folder",
                              {:confirm => "Deleting this folder will remove all subfolders, and move any files to the #{unsorted_folder}. It is not reversible. Are you sure you want to delete?",
                               :method => :delete},
                              "Delete this folder"
        -%>
        </div>
    <% end -%>

    <% if @folder.editable? %>
        <div>
        <%= image_tag_for_key "add", "javascript:Effect.Appear('new_child');new Effect.Highlight('new_child');",
                              "Add subfolder",
                              {},
                              "Add a sub-folder",
                              :function
        -%>
        </div>
    <% end -%>

  </li>

</ul>

<div style='clear:both;'>&nbsp;</div>

<% if @folder.editable? -%>
    <div id='new_child' style='display:none;'>
      <% form_remote_tag :url=>{:action=>:create_folder, :id=>@folder.id}, :html=>{:id=>:create_child_form} do -%>
              <%= label_tag "Create a new sub-folder:" -%>
              <%= hidden_field_tag :project_id, @folder.project.id -%>
              <%= text_field_tag :title -%>
              <%= submit_tag(:create, :onclick=>"javascript: create_child();") -%>
          <% end -%>

        </div>
<% end -%>

<% if @folder.is_a?(Seek::AssayFolder) -%>
    <div id="remove_from_assay_surround">
        <div id="remove_from_assay_drop_area" style="display:none;">
          <p>Drop here to remove from the assay</p>
        </div>
    </div>
    <script type="text/javascript">
      Droppables.add("remove_from_assay_drop_area", {accept:'draggable_assay_folder_item', hoverclass:'folder_hover', onDrop:function(element, droppable_element) {
                    remove_item_from_assay(element, droppable_element, <%= @project.id -%>);
      }});
    </script>
<% end -%>

